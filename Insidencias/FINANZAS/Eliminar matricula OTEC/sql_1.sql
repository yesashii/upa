-- se seleccionan los ruts involucrados:

select * 
from   postulacion_otec 
where  pers_ncorr in (select pers_ncorr 
                      from   personas 
                      where  pers_nrut in ( '16657576', '14183788', '14412292', '13721634' )) 
					  
/*
pote_ncorr	pers_ncorr	epot_ccod	fecha_postulacion	dgso_ncorr	utiliza_sence	fpot_ccod	empr_ncorr_empresa	norc_empresa	empr_ncorr_otic	norc_otic	nied_ccod	tdet_ccod	datos_persona_correctos	datos_empresa_correctos	datos_otic_correctos	AUDI_TUSUARIO	AUDI_FMODIFICACION	comp_ndocto	pote_nnota_final	pote_nasistencia	pote_nest_final	audi_tfinal	audi_ffinal	vb_finanzas	vb_biblioteca	vb_audiovisual	audi_tvb	audi_fvb
11436	241526	4	2013-07-22 16:19:19.877	728	0	1	NULL	NULL	NULL	NULL	1	0	1	NULL	NULL	7741733	2013-07-23 12:50:42.763	252526	6.2	100	2	7741733	2013-08-13 11:11:13.727	NULL	NULL	NULL	NULL	NULL
17794	251198	4	2016-03-24 11:31:23.120	1044	0	5	26687	24032016	NULL	NULL	8	0	1	1	NULL	16657576	2016-03-24 12:30:07.983	337169	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
17795	20341	4	2016-03-24 11:47:27.870	1044	0	2	26687	24032016	NULL	NULL	8	0	1	1	NULL	16657576	2016-03-24 12:30:07.983	337169	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
17796	241526	4	2016-03-24 12:27:37.423	1044	0	1	NULL	NULL	NULL	NULL	8	0	1	NULL	NULL	16657576	2016-03-24 12:35:28.010	337170	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL

*/					  

-- se anulan los contratos
update postulacion_otec
set epot_ccod = 5
-- select * from postulacion_otec
where  pers_ncorr in (select pers_ncorr 
                      from   personas 
                      where  pers_nrut in ( '16657576', '14183788', '14412292', '13721634' )) 
-- (4 filas afectadas)

-- se eliminan los ingresos

select * 
from   ingresos 
where  ingr_ncorr in ( 1573280, 1573281, 1573282, 1573283, 1573284 ) 

/*
INGR_NCORR	MCAJ_NCORR	EING_CCOD	INGR_FPAGO	INGR_MEFECTIVO	INGR_MDOCTO	INGR_MTOTAL	INGR_NESTADO	INGR_NFOLIO_REFERENCIA	TING_CCOD	AUDI_TUSUARIO	AUDI_FMODIFICACION	INST_CCOD	INGR_MINTERESES	INGR_MMULTAS	PERS_NCORR	INGR_MANTICIPADO	INEM_CCOD	TMOV_CCOD	GLOSA_FOX	INGR_NCORRELATIVO_CAJA	MCAJ_NCORR_ORIGEN
1573280	23393	4	2016-03-24 12:35:27.880	0.00	50000.00	50000.00	NULL	781520	33	GENERA_PACTACION	2016-03-24 12:35:27.880	1	NULL	NULL	241526	NULL	NULL	NULL	NULL	3	NULL
1573281	23393	4	2016-03-24 12:35:27.900	0.00	50000.00	50000.00	NULL	781520	33	GENERA_PACTACION	2016-03-24 12:35:27.900	1	NULL	NULL	241526	NULL	NULL	NULL	NULL	3	NULL
1573282	23393	4	2016-03-24 12:35:27.917	0.00	50000.00	50000.00	NULL	781520	33	GENERA_PACTACION	2016-03-24 12:35:27.917	1	NULL	NULL	241526	NULL	NULL	NULL	NULL	3	NULL
1573283	23393	4	2016-03-24 12:35:27.940	0.00	50000.00	50000.00	NULL	781520	33	GENERA_PACTACION	2016-03-24 12:35:27.940	1	NULL	NULL	241526	NULL	NULL	NULL	NULL	3	NULL
1573284	23393	4	2016-03-24 12:35:27.947	0.00	50000.00	50000.00	NULL	781520	33	GENERA_PACTACION	2016-03-24 12:35:27.947	1	NULL	NULL	241526	NULL	NULL	NULL	NULL	3	NULL

*/

select * 
from   detalle_ingresos 
where  ingr_ncorr in ( 1573280, 1573281, 1573282, 1573283, 1573284 ) 					  

/*
TING_CCOD	DING_NDOCTO	INGR_NCORR	DING_NSECUENCIA	DING_NCORRELATIVO	PLAZ_CCOD	BANC_CCOD	DING_FDOCTO	DING_MDETALLE	DING_MDOCTO	DING_TCUENTA_CORRIENTE	EDIN_CCOD	ENVI_NCORR	REPA_NCORR	DING_BPACTA_CUOTA	PERS_NCORR_CODEUDOR	AUDI_TUSUARIO	AUDI_FMODIFICACION	ding_tplaza_sbif	esed_ncorr	sede_actual
3	222	1573280	999749330	1	1	17	2016-04-24 00:00:00.000	50000.00	50000.00	433434	1	NULL	NULL	S	241526	GENERA_PACTACION	2016-03-24 12:35:27.880	NULL	NULL	NULL
3	223	1573281	999749331	1	1	17	2016-05-24 00:00:00.000	50000.00	50000.00	433434	1	NULL	NULL	S	241526	GENERA_PACTACION	2016-03-24 12:35:27.900	NULL	NULL	NULL
3	224	1573282	999749332	1	1	17	2016-06-24 00:00:00.000	50000.00	50000.00	433434	1	NULL	NULL	S	241526	GENERA_PACTACION	2016-03-24 12:35:27.937	NULL	NULL	NULL
3	225	1573283	999749333	1	1	17	2016-07-24 00:00:00.000	50000.00	50000.00	433434	1	NULL	NULL	S	241526	GENERA_PACTACION	2016-03-24 12:35:27.940	NULL	NULL	NULL
3	226	1573284	999749334	1	1	17	2016-08-24 00:00:00.000	50000.00	50000.00	433434	1	NULL	NULL	S	241526	GENERA_PACTACION	2016-03-24 12:35:27.947	NULL	NULL	NULL

*/

select * 
from   abonos 
where  ingr_ncorr in ( 1573280, 1573281, 1573282, 1573283, 1573284 ) 

/*
INGR_NCORR	TCOM_CCOD	INST_CCOD	COMP_NDOCTO	DCOM_NCOMPROMISO	DCOM_MTRASPASADO	ABON_FABONO	ABON_MABONO	AUDI_TUSUARIO	AUDI_FMODIFICACION	PERS_NCORR	PERI_CCOD	INEM_CCOD
1573280	7	1	337170	1	NULL	2016-03-24 12:35:27.880	50000.00	GENERA_PACTACION	2016-03-24 12:35:27.880	241526	242	NULL
1573281	7	1	337170	2	NULL	2016-03-24 12:35:27.900	50000.00	GENERA_PACTACION	2016-03-24 12:35:27.900	241526	242	NULL
1573282	7	1	337170	3	NULL	2016-03-24 12:35:27.917	50000.00	GENERA_PACTACION	2016-03-24 12:35:27.917	241526	242	NULL
1573283	7	1	337170	4	NULL	2016-03-24 12:35:27.940	50000.00	GENERA_PACTACION	2016-03-24 12:35:27.940	241526	242	NULL
1573284	7	1	337170	5	NULL	2016-03-24 12:35:27.947	50000.00	GENERA_PACTACION	2016-03-24 12:35:27.947	241526	242	NULL
*/

delete from ingresos 
-- select * from ingresos
where  ingr_ncorr in ( 1573280, 1573281, 1573282, 1573283, 1573284 ) 

delete from detalle_ingresos 
-- select * from detalle_ingresos
where  ingr_ncorr in ( 1573280, 1573281, 1573282, 1573283, 1573284 ) 

delete from abonos 
-- select * from abonos
where  ingr_ncorr in ( 1573280, 1573281, 1573282, 1573283, 1573284 ) 